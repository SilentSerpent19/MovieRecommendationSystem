{% extends 'base.html' %}
{% block content %}
<div class="analytics-header">
  <h1 class="cinema-title">Analytics Dashboard</h1>
  <p class="cinema-subtitle">See what's trending in the cinephile community.</p>
</div>
{% if messages %}
  <ul class="messages cinema-alert">{% for message in messages %}<li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>{% endfor %}</ul>
{% endif %}
<div class="analytics-cards">
  <div class="analytics-card glass">
    <h4>Most Watchlisted Movies (All Time)</h4>
    <ul class="analytics-list">
      {% for movie, count in popular_movies %}
        <li>{{ movie.title }} ({{ movie.year }}) <span class="analytics-badge">{{ count }}</span></li>
      {% empty %}
        <li>No data.</li>
      {% endfor %}
    </ul>
  </div>
  <div class="analytics-card glass">
    <h4>Trending Movies (Last 30 Days)</h4>
    <ul class="analytics-list">
      {% for movie, count in trending_movies %}
        <li>{{ movie.title }} ({{ movie.year }}) <span class="analytics-badge">{{ count }}</span></li>
      {% empty %}
        <li>No data.</li>
      {% endfor %}
    </ul>
  </div>
  <div class="analytics-card glass">
    <h4>Most Watchlisted Genres (All Time)</h4>
    <ul class="analytics-list">
      {% for genre, count in popular_genres %}
        <li>{{ genre }} <span class="analytics-badge">{{ count }}</span></li>
      {% empty %}
        <li>No data.</li>
      {% endfor %}
    </ul>
  </div>
  <div class="analytics-card glass">
    <h4>Trending Genres (Last 30 Days)</h4>
    <ul class="analytics-list">
      {% for genre, count in trending_genres %}
        <li>{{ genre }} <span class="analytics-badge">{{ count }}</span></li>
      {% empty %}
        <li>No data.</li>
      {% endfor %}
    </ul>
  </div>
  <div class="analytics-card glass">
    <h4>Most Recommended Movies</h4>
    <ul class="analytics-list">
      {% for movie, count in most_rec_movies %}
        <li>{{ movie.title }} ({{ movie.year }}) <span class="analytics-badge">{{ count }}</span></li>
      {% empty %}
        <li>No data.</li>
      {% endfor %}
    </ul>
  </div>
  <div class="analytics-card glass">
    <h4>Most Recommended Genres</h4>
    <ul class="analytics-list">
      {% for genre, count in most_rec_genres %}
        <li>{{ genre }} <span class="analytics-badge">{{ count }}</span></li>
      {% empty %}
        <li>No data.</li>
      {% endfor %}
    </ul>
  </div>
  <div class="analytics-card glass">
    <h4>Most Active Users (Watchlist Adds)</h4>
    <ul class="analytics-list">
      {% for user, count in most_active_users %}
        <li>{{ user.username }} <span class="analytics-badge">{{ count }}</span></li>
      {% empty %}
        <li>No data.</li>
      {% endfor %}
    </ul>
  </div>
  <div class="analytics-card glass">
    <h4>Average IMDb Rating of Watchlisted Movies</h4>
    <div style="font-size:1.5rem;font-weight:700;color:#ffd700;">
      {% if avg_rating %}{{ avg_rating|floatformat:2 }}{% else %}N/A{% endif %}
    </div>
  </div>
</div>
<a href="{% url 'recommend' %}" class="cinema-btn cinema-btn-secondary mt-3">Back to Recommendations</a>
{% endblock %} 